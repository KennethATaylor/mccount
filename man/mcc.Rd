% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mcc.R
\name{mcc}
\alias{mcc}
\title{Calculate Mean Cumulative Count (MCC)}
\usage{
mcc(
  data,
  id_var,
  time_var,
  cause_var,
  method = c("equation", "sci"),
  tstart_var = NULL,
  adjust_times = TRUE,
  time_precision = 1e-06
)
}
\arguments{
\item{data}{(\code{data.frame} or \code{tbl_df})\cr
A \code{data.frame} or tibble containing the required variables}

\item{id_var}{(\code{string})\cr
Name of the column containing participant identifiers}

\item{time_var}{(\code{string})\cr
Name of the column containing follow-up times}

\item{cause_var}{(\code{string})\cr
Name of the column containing event indicator values (1 = event of
interest, 2 = competing risk, 0 = censoring)}

\item{method}{(\code{string})\cr
Method to use for MCC calculation. Either \code{"equation"} (default) or
\code{"sci"} (sum of cumulative incidence)}

\item{tstart_var}{(\code{string})\cr
Name of the column containing start times of follow-up for incorporating
left truncation. Only allowed to be specified when \code{method = "sci"}. If
\code{NULL} (default), a constant value of \code{0} is used in calculation (i.e.,
right truncation only).}

\item{adjust_times}{(\code{logical})\cr
If \code{TRUE} (default), automatically adjusts times to account for outcome
events and competing risk events occurring at the same time.}

\item{time_precision}{(\code{numeric})\cr
Precision used for adjusting simultaneous events (default: 1e-6). Must
be a positive numeric value.}
}
\value{
A list with method-specific components:

For \code{method = "equation"}:
\itemize{
\item \code{mcc_final}: A tibble with columns for time and MCC
\item \code{mcc_table}: A tibble with detailed calculation steps
\item \code{original_data}: The input data with standardized column names
\item \code{adjusted_data}: Present only if time adjustments were applied
\item \code{method}: The method used for calculation
}

For \code{method = "sci"}:
\itemize{
\item \code{mcc_final}: A tibble with columns for time and MCC (expressed as SumCIs)
\item \code{sci_table}: A tibble with cumulative incidence for each event number and their sum
\item \code{all_cis}: A list of cumulative incidence data for each event number
\item \code{mcc_base}: A tibble with calculation details for the MCC
\item \code{original_data}: The input data with standardized column names
\item \code{adjusted_data}: Present only if time adjustments were applied
\item \code{method}: The method used for calculation
}
}
\description{
Calculates the Mean Cumulative Count (MCC), which estimates the expected
cumulative number of events per person over time, while accounting for
potential competing risks and censoring. This function provides a unified
interface to two different estimation approaches: the \code{"equation"} method and
the sum of cumulative incidence (\code{"sci"}) method.

The \code{"equation"} method calculates MCC directly through probability
calculations, while the \code{"sci"} method derives MCC by summing the cumulative
incidence functions for each recurrent event. The two approaches yield
equivalent results in certain circumstances. When they do not, the choice
between methods depends on the specific outcome, analysis needs, and data
structure.
}
\examples{
# Create sample data with recurrent events
df <- data.frame(
  id = c(1, 2, 3, 4, 4, 4, 5, 5),
  time = c(8, 1, 5, 2, 6, 7, 3, 3), # Times will be adjusted for id = 5
  cause = c(0, 0, 2, 1, 1, 1, 1, 2)
)
# Sort the data by id and time
df <- df |>
  dplyr::arrange(id, time)

# Print the dataset
print("Hypothetical dataset from Dong et al. (2015):")
print(df)

# Calculate MCC using the equation method (default)
mcc_eq <- mcc(df, id_var = "id", time_var = "time", cause_var = "cause")

# MCC table
mcc_eq$mcc_table

# MCC estimates
mcc_eq$mcc_final

# Calculate MCC using the sum of cumulative incidence method
mcc_sci <- mcc(
  df,
  id_var = "id",
  time_var = "time",
  cause_var = "cause",
  method = "sci"
)

# MCC (SCI) table
mcc_sci$sci_table

# MCC estimates
mcc_sci$mcc_final

# Clean up
rm(df)
rm(mcc_eq)
rm(mcc_sci)

}
\references{
Dong H, Robison LL, Leisenring WM, Martin LJ, Armstrong GT, Yasui Y.
Estimating the burden of recurrent events in the presence of competing
risks: the method of mean cumulative count. \emph{Am J Epidemiol}. 2015 Apr
1;181(7):532-40. doi: \href{https://doi.org/10.1093/aje/kwu289}{10.1093/aje/kwu289}
}
